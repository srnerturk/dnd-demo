const gameState={player:{name:"",level:1,xp:0,xpNeeded:100,health:100,maxHealth:100,strength:15,gold:0,x:0,y:0},map:{size:10,revealed:new Set,enemies:new Map}},enemies=[{name:"İskelet Savaş\xe7ı",health:30,damage:5,xp:25,gold:"5-15"},{name:"Goblin Yağmacı",health:20,damage:8,xp:20,gold:"3-12"},{name:"Karanlık B\xfcy\xfcc\xfc",health:40,damage:12,xp:35,gold:"10-20"},{name:"Zehirli \xd6r\xfcmcek",health:25,damage:6,xp:15,gold:"4-10"},{name:"Lanetli Ruh",health:35,damage:10,xp:30,gold:"8-18"}],mapSymbols={player:"P",empty:"\xb7",unknown:"█",enemy:"E"};function initializeMap(){for(let e=0;e<15;e++){let t,a;do t=Math.floor(Math.random()*gameState.map.size),a=Math.floor(Math.random()*gameState.map.size);while(gameState.map.enemies.has(`${t},${a}`));let l=enemies[Math.floor(Math.random()*enemies.length)];gameState.map.enemies.set(`${t},${a}`,{...l})}updateMap()}function updateMap(){let e="";for(let t=0;t<gameState.map.size;t++){for(let a=0;a<gameState.map.size;a++){let l=`${a},${t}`;a===gameState.player.x&&t===gameState.player.y?e+=mapSymbols.player:gameState.map.revealed.has(l)?e+=gameState.map.enemies.has(l)?mapSymbols.enemy:mapSymbols.empty:e+=mapSymbols.unknown,e+=" "}e+="\n"}document.getElementById("map-display").textContent=e}function revealNearby(){let e=gameState.player.x,t=gameState.player.y;for(let a=-1;a<=1;a++)for(let l=-1;l<=1;l++){let n=e+l,o=t+a;n>=0&&n<gameState.map.size&&o>=0&&o<gameState.map.size&&gameState.map.revealed.add(`${n},${o}`)}}function move(e){let[t,a]={north:[0,-1],south:[0,1],east:[1,0],west:[-1,0]}[e],l=gameState.player.x+t,n=gameState.player.y+a;if(l>=0&&l<gameState.map.size&&n>=0&&n<gameState.map.size){gameState.player.x=l,gameState.player.y=n,document.getElementById("location").textContent=`${l},${n}`,revealNearby(),updateMap();let o=`${l},${n}`;if(gameState.map.enemies.has(o)){let r=gameState.map.enemies.get(o);writeToLog(`<span class="combat-text">Bir ${r.name} ile karşılaştın!</span>`),fight(r),gameState.map.enemies.delete(o),updateMap()}else writeToLog(`<span class="location-text">Yeni konuma hareket ettin (${l},${n})</span>`)}else writeToLog("Bu y\xf6ne gidemezsin!")}function addXP(e){gameState.player.xp+=e;let t=gameState.player.xp/gameState.player.xpNeeded*100,a=document.getElementById("xp-bar");a.style.width=`${Math.min(t,100)}%`,a.innerHTML=`%${Math.floor(t)}`,gameState.player.xp>=gameState.player.xpNeeded&&levelUp()}function levelUp(){gameState.player.level++,gameState.player.xp-=gameState.player.xpNeeded,gameState.player.xpNeeded=Math.floor(1.5*gameState.player.xpNeeded),gameState.player.maxHealth+=20,gameState.player.health=gameState.player.maxHealth,gameState.player.strength+=5,document.getElementById("level").textContent=gameState.player.level,document.getElementById("health").textContent=gameState.player.health,document.getElementById("max-health").textContent=gameState.player.maxHealth,document.getElementById("strength").textContent=gameState.player.strength;let e=gameState.player.xp/gameState.player.xpNeeded*100,t=document.getElementById("xp-bar");t.style.width=`${Math.min(e,100)}%`,t.innerHTML=`%${Math.floor(e)}`,confetti({particleCount:200,spread:160,origin:{y:.6},colors:["#90EE90","#98FB98","#32CD32"]}),writeToLog(`<span class="level-up-text">Seviye atladın! Artık ${gameState.player.level}. seviyedesin!</span>`)}function fight(e){let t=rollDice(20),a=rollDice(20),l=Math.floor(a/20*e.damage)+1,n=Math.floor(t/20*gameState.player.strength)+1;showDiceAnimation("player",t,()=>{showDiceAnimation("enemy",a,()=>{gameState.player.health-=l,document.getElementById("health").textContent=gameState.player.health;let[o,r]=e.gold.split("-").map(Number),m=Math.floor(Math.random()*(r-o+1))+o;gameState.player.gold+=m,document.getElementById("gold").textContent=gameState.player.gold,writeToLog(`<span class="combat-text">Savaş sonucu:</span>`),writeToLog(`<span class="combat-text">Senin zarın: ${t} (${n} hasar)</span>`),writeToLog(`<span class="combat-text">D\xfcşmanın zarı: ${a} (${l} hasar)</span>`),writeToLog(`<span class="combat-text">- ${l} hasar aldın</span>`),writeToLog(`<span class="combat-text">- D\xfcşmana ${n} hasar verdin</span>`),writeToLog(`<span class="loot-text">+ ${m} altın kazandın</span>`),writeToLog(`<span class="loot-text">+ ${e.xp} tecr\xfcbe puanı kazandın</span>`),fireConfetti(),addXP(e.xp),gameState.player.health<=0&&(writeToLog('<span class="combat-text">\xd6LD\xdcN! Oyun yeniden başlıyor...</span>'),resetGame())})})}function fireConfetti(){confetti({particleCount:100,spread:70,origin:{x:.1,y:.6}}),confetti({particleCount:100,spread:70,origin:{x:.9,y:.6}}),confetti({particleCount:50,spread:90,origin:{y:.7},colors:["#FFD700","#FFA500","#FF8C00"]}),setTimeout(()=>{confetti({particleCount:30,angle:60,spread:55,origin:{x:0},gravity:.5}),confetti({particleCount:30,angle:120,spread:55,origin:{x:1},gravity:.5})},200)}function resetGame(){gameState.player={name:"",level:1,xp:0,xpNeeded:100,health:100,maxHealth:100,strength:15,gold:0,x:0,y:0},updateStats(),gameState.map.enemies.clear(),gameState.map.revealed.clear(),initializeMap()}function updateStats(){document.getElementById("level").textContent=gameState.player.level,document.getElementById("xp").textContent=gameState.player.xp,document.getElementById("xp-needed").textContent=gameState.player.xpNeeded,document.getElementById("health").textContent=gameState.player.health,document.getElementById("max-health").textContent=gameState.player.maxHealth,document.getElementById("strength").textContent=gameState.player.strength,document.getElementById("gold").textContent=gameState.player.gold,document.getElementById("location").textContent=`${gameState.player.x},${gameState.player.y}`}function processCommand(){let e=playerInput.value.toLowerCase();switch(playerInput.value="",e){case"help":writeToLog("Kullanılabilir komutlar:"),writeToLog("- look: Etrafı kontrol et"),writeToLog("- north: Kuzeye git"),writeToLog("- south: G\xfcneye git"),writeToLog("- east: Doğuya git"),writeToLog("- west: Batıya git"),writeToLog("- stats: Karakter durumunu g\xf6ster");break;case"north":case"south":case"east":case"west":move(e);break;case"look":let t=`${gameState.player.x},${gameState.player.y}`;if(gameState.map.enemies.has(t)){let a=gameState.map.enemies.get(t);writeToLog(`<span class="combat-text">Dikkatli ol! Burada bir ${a.name} var!</span>`)}else writeToLog('<span class="location-text">Etraf sakin g\xf6r\xfcn\xfcyor.</span>');break;case"stats":writeToLog(`İsim: ${gameState.player.name}`),writeToLog(`Seviye: ${gameState.player.level}`),writeToLog(`XP: ${gameState.player.xp}/${gameState.player.xpNeeded}`),writeToLog(`Can: ${gameState.player.health}/${gameState.player.maxHealth}`),writeToLog(`G\xfc\xe7: ${gameState.player.strength}`),writeToLog(`Altın: ${gameState.player.gold}`);break;default:writeToLog('Ge\xe7ersiz komut. Yardım i\xe7in "help" yazın.')}}function writeToLog(e){gameLog.innerHTML+=`<p>${e}</p>`,gameLog.scrollTop=gameLog.scrollHeight}const gameLog=document.getElementById("game-log"),playerInput=document.getElementById("player-input");function rollDice(e){return Math.floor(Math.random()*e)+1}function showDiceAnimation(e,t,a){let l=document.createElement("div");l.className="dice-animation",l.style.position="fixed",l.style.left="50%",l.style.top="50%",l.style.transform="translate(-50%, -50%)",l.style.fontSize="48px",l.style.fontWeight="bold",l.style.color="player"===e?"#4a5":"#f45",document.body.appendChild(l);let n=0,o=()=>{++n<20?(l.textContent=Math.floor(20*Math.random())+1,requestAnimationFrame(o)):(l.textContent=t,setTimeout(()=>{l.remove(),a&&a()},1e3))};o()}writeToLog('<span style="color: #ffd700">Ancient Realms\'e Hoş Geldiniz!</span>'),writeToLog('Komutlar i\xe7in "help" yazın.'),initializeMap(),revealNearby(),playerInput.addEventListener("keypress",function(e){"Enter"===e.key&&processCommand()});const style=document.createElement("style");function startGame(){let e=document.getElementById("characterName"),t=e.value.trim();if(t.length<1){alert("L\xfctfen bir karakter adı girin!");return}gameState.player.name=t,document.getElementById("char-name").textContent=t;let a=bootstrap.Modal.getInstance(document.getElementById("characterModal"));a.hide(),initializeMap(),writeToLog(`<span style="color: #ffd700">Hoş geldin, ${t}! Ancient Realms'deki macerana başlayabilirsin.</span>`),writeToLog('Komutlar i\xe7in "help" yazın.')}style.textContent=`
        @keyframes diceRoll {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }
        .dice-animation {
            animation: diceRoll 0.5s ease-out;
            z-index: 1000;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
    `,document.head.appendChild(style),document.addEventListener("DOMContentLoaded",function(){let e=new bootstrap.Modal(document.getElementById("characterModal"));e.show()});